# pentest_vagrant_lab_libvirt
Pentest Lab using Vagrant with the Libvirt Provider


## Vagrant Lab for Metasploitable3 and Kali Linux

This installation process covers Debian distributions of linux using KVM/libvirt. The Vagrant file should work with other distributions but, I have only tested it with Debian based distros. 

Vagrant Version:
    2.2.9

Inventory:
    1 x Kali Linux
    1 x Metasploitable3 - Ubuntu 14.04 
    1 x Metasploitable3 - Windows 2008


NOTE- the Windows machine requires 4 Gigs of Ram to work properly



***

### Discussion
This is a personal opinion but I believe that Virtualbox is garbage. My experience with it have been mixed and it is probably fine for most users but, not for many of my use cases. At the end of the day Virtualbox is a Type 2 Hypervisor and is bulkier and takes more resources than other solutions. In this setup we are going to use KVM (Layer 1 Hypervisor) and automate the deployment with Vagrant. 

So, I tried a couple of different routes with mixed success. You do have the option of building the Vagrant boxes from scratch. The big problem is that rapid7 stopped supporting libvirt.
(Libvirt is the API for KVM and the Vagrant KVM provider is no longer supported because it is basically redundant.) Mutating a Virtualbox-Vagrantbox to support libvirt works great for the Kali/Ubuntu machines. The Windows box is a little more tricky. To make things easier, I have located the correct Vagrant boxes and added them to the Vagrant file. When the environment comes up, they will be install automatically. 

If anyone has suggestions; PULL REQUEST PLEASE

***

### Install KVM and Libvirt

If you don't have KVM installed


```
   sudo apt update
   sudo apt-get install qemu-kvm libvirt-clients libvirt-daemon-system libvirt-dev qemu-utils qemu
   systemctl status libvirtd.service
```

>> You should see the service active (running) at this point

Reference:
https://wiki.debian.org/KVM

***

### Install Vagrant

Find the Appropriate Package:
https://www.vagrantup.com/downloads

Download and install it. 

```
vagrant --version
Vagrant 2.2.9
```

`vagrant plugin install vagrant-libvirt`


### Install the Required Vagrant Plugin




### Running the Vagrant File


  

  
1) Create a Directory to Store These
`mkdir CYB6020`

2) Place the Vagrant File in there

3) Turn This Up
`vagrant up`



* To See Your Inventory
`vagrant status`

* To Connect Via SSH
`vagrant ssh <hostname>`





GUI Password 
username:  vagrant
password:  vagrant




















>> If there is ever doubt just try     `↑↑↓↓←→←→BA`
